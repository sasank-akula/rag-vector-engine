//@ui5-bundle com/ai/ragui/Component-preload.js
sap.ui.predefine("com/ai/ragui/Component", ["sap/ui/core/UIComponent","com/ai/ragui/model/models"],(e,i)=>{"use strict";return e.extend("com.ai.ragui.Component",{metadata:{manifest:"json",interfaces:["sap.ui.core.IAsyncContentCreation"]},init(){e.prototype.init.apply(this,arguments);this.setModel(i.createDeviceModel(),"device");this.getRouter().initialize()}})});
sap.ui.predefine("com/ai/ragui/controller/App.controller", ["sap/ui/core/mvc/Controller"],e=>{"use strict";return e.extend("com.ai.ragui.controller.App",{onInit(){}})});
sap.ui.predefine("com/ai/ragui/controller/BaseController", ["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/base/util/uid","sap/m/MessageBox","sap/m/MessageToast"],(e,t,r,s,o)=>{"use strict";return e.extend("com.ai.ragui.controller.BaseController",{onInit(){},_getServicePath:function(){let e=this.getOwnerComponent().getManifestEntry("/sap.app/id");let t=e.replaceAll(".","/");let r=sap.ui.require.toUrl(t?.replaceAll(".","/"));return r},_getRagResponse:async function(e){let t=this.byId("userInput");let r=t.getValue().trim();if(!r)return;let s=this.getView().getModel("oChatModel");let o=s.getProperty("/list")||[];if(!s.getProperty("/started")){s.setProperty("/started",true)}o.push({type:"query",text:r,busy:false});o.push({type:"response",text:"",busy:true});s.setProperty("/list",o);let n=this;let l=(new Date).toISOString();let i={conversationId:e,messageId:"",message_time:l,user_id:"user_id-24045578",user_query:r};$.ajax({url:this._getServicePath()+"/odata/v4/roadshow/getChatRagResponse",type:"POST",contentType:"application/json",data:JSON.stringify(i),success:function(e){let t=s.getProperty("/list")||[];if(t.length>0&&t[t.length-1].busy){t[t.length-1]={type:"response",text:e.content,busy:false};s.setProperty("/list",t)}n.scrollChat()},error:function(){let e=s.getProperty("/list")||[];if(e.length>0&&e[e.length-1].busy){e[e.length-1]={type:"response",text:"Something went wrong.",busy:false};s.setProperty("/list",e)}n.scrollChat()}});t.setValue("");n.scrollChat()},onQuickAction:function(e){let t=e.getSource().getText();this.byId("jouleInput").setValue(t);this.onSend()},openFragment:function(e){let r=this.getView();return t.load({id:r.getId(),name:e,controller:this}).then(function(e){r.addDependent(e);return e})},ODataPost:function(e,t){let r=this.getView().getModel();let n=r.bindList(e);let l=n.create(t);l.created().then(()=>{o.show("File Uploaded successfully!")}).catch(e=>{s.error("Error creating data: "+e.message);console.error("Creation error:",e)})},scrollChat:function(){setTimeout(()=>{let e=this.byId("chatScroll");if(e){e.scrollTo(0,1e6,200)}},150)}})});
sap.ui.predefine("com/ai/ragui/controller/Main.controller", ["com/ai/ragui/controller/BaseController","sap/ui/model/json/JSONModel","sap/base/util/uid","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/Filter","sap/ui/model/FilterOperator"],(e,t,n,i,o,s,a)=>{"use strict";return e.extend("com.ai.ragui.controller.Main",{onInit:function(){this._oDSC=this.byId("DynamicSideContent");this._showSideContentButton=this.byId("showSideContentButton");this.flag=0},_getLoggedInUserDetails:function(){let e=this._getServicePath()+"/user-api/currentUser";let n=this;$.ajax({url:e,type:"GET",dataType:"json",async:true,success:function(e){let i=new t(e);n.getView().setModel(i,"UserData");n.handleSideContentHide(i.getData())},error:function(){i.show("Fething User Details failed")}})},onAfterRendering:function(){this._getLoggedInUserDetails();let e=this._oDSC.getCurrentBreakpoint();this.updateToggleButtonState(e)},handleSliderChange:function(e){let t=e.getParameter("value");this.updateControlWidth(t)},updateControlWidth:function(e){let t=this.byId("sideContentContainer").$();if(e){t.width(e+"%")}},handleBreakpointChangeEvent:function(e){let t=e.getParameter("currentBreakpoint");this.updateToggleButtonState(t);this.updateShowSideContentButtonVisibility(t)},updateToggleButtonState:function(e){let t=this.byId("toggleButton");t.setEnabled(e==="S")},updateShowSideContentButtonVisibility:function(e){let t=!(e==="S"||this._oDSC.isSideContentVisible());this._showSideContentButton.setVisible(t)},handleToggleClick:function(){this._oDSC.toggle()},handleSideContentHide:function(e){let t=e.scopes||[];console.log(t);let n=t.inludes("rag-vector-engine-9d5a94ectrial-dev!t485944.ChatBotAdmin");console.log(n);this.getView().getModel("UserData").setProperty("/showSideContent",n)},handleSideContentShow:function(){this._oDSC.setShowSideContent(true);this.updateShowSideContentButtonVisibility(this._oDSC.getCurrentBreakpoint())},onSendMessage:async function(){if(this.flag===0){this.convId=n();this.flag=1}await this._getRagResponse(this.convId)},onReloadChat:function(){this.convId=n();const e=this.getView().getModel("oChatModel");e.setProperty("/list",[])},onFileSizeExceed:function(e){o.warning("File size exceeds the 5 MB limit.")},onChange:function(e){debugger;const t=e.getParameter("files");this.onAfterItemAdded(t[0])},onAfterItemAdded:async function(e){debugger;const t=new FileReader;t.onload=async t=>{const n=t.target.result.split(",")[1];const o={getMediaType:()=>e.type,getFileName:()=>e.name,getFileObject:()=>e,base64Content:n};this._showBusy(true);try{await this.createEntity(o);i.show(`File is Uploading.....`);this.byId("idList").getBinding("items").refresh()}catch(e){console.error("Upload failed:",e);i.show("Upload failed")}finally{this._showBusy(false)}};t.onerror=e=>{console.error("File reading error:",e);i.show("File read error")};t.readAsDataURL(e)},onUploadCompleted:function(){const e=this.byId("UploadCollection");e.getBinding("items").refresh()},fileSizeExceed:function(e){o.warning("File size exceeded. Maximum allowed is 250 KB.")},typeMissmatch:function(e){o.warning("Invalid file type. Only PDFs are allowed.")},createEntity:async function(e){debugger;const t={ID:self.crypto.randomUUID(),mediaType:e.getMediaType(),fileName:e.getFileName(),size:e.getFileObject().size.toString(),content:e.base64Content};this.ODataPost("/DocumentFiles",t);this.byId("idList").getBinding("items").refresh()},_getEmbeddingResponse:async function(e){const t=sessionStorage.getItem("isDeployedVersion")==="true"?this._getServicePath()+"/odata/v4/embedding-storage/storeEmbeddings":"/odata/v4/embedding-storage/storeEmbeddings";return new Promise((n,o)=>{$.ajax({url:t+"(documentID='"+e+"')",method:"GET"}).done(e=>{i.show("you can ask now..")}).fail(e=>{o(e)})})},onFileDeleted:async function(e){const t=e.getParameter("listItem");const n=t.getBindingContext().getProperty("ID");this._showBusy(true);try{await this.deleteItemById(n);i.show("File deleted successfully.");this.byId("idList").getBinding("items").refresh()}catch(e){i.show("Error deleting file.");console.error(e)}finally{this._showBusy(false)}},deleteItemById:function(e){const t=this.getView().getModel();const n=t.bindList("/DocumentFiles");const i=new s("ID",a.EQ,e);return n.filter(i).requestContexts().then(function(e){if(e.length>0){return e[0].delete()}else{return Promise.reject("No matching item found")}})},_showBusy:function(e){const t=this.getView();t.setBusyIndicatorDelay(0);t.setBusy(e)},onDeleteDocumentPress:async function(e){await this.deleteItemById(e.getParameter("documentId"));i.show("FileDeleted event triggered.")},onSearchDocuments:function(e){const t=e.getParameter("query");const n=this.byId("idList");const i=n.getBinding("items");if(t&&t.length>0){const e=new s("fileName",a.Contains,t);i.filter([e])}else{i.filter([])}},updateFileCount:function(e){let t=e.getParameter("total");let n=this.byId("documentCount");if(t&&n){n.setText("Documents ("+t+")")}}})});
sap.ui.predefine("com/ai/ragui/model/models", ["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
sap.ui.require.preload({
	"com/ai/ragui/i18n/i18n.properties":'# This is the resource bundle for com.ai.ragui\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Chat Bot\n\n#YDES: Application description\nappDescription= A ChatBot application gives the rag responsed based on document context\n#XTIT: Main view title\ntitle=Chat Bot\n\n#XFLD,24\nrag_vector_engine-Display.flpTitle=Chat Bot\n',
	"com/ai/ragui/manifest.json":'{"_version":"1.65.0","sap.app":{"id":"com.ai.ragui","type":"application","i18n":{"bundleUrl":"i18n/i18n.properties","supportedLocales":[""]},"applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.18.4","toolsId":"523bb043-820c-40f2-a589-b3bea4fbcf71"},"dataSources":{"mainService":{"uri":"/odata/v4/embedding-storage/","type":"OData","settings":{"annotations":[],"odataVersion":"4.0"}}},"crossNavigation":{"inbounds":{"rag_vector_engine-Display":{"semanticObject":"rag_vector_engine","action":"Display","title":"{{rag_vector_engine-Display.flpTitle}}","signature":{"parameters":{},"additionalParameters":"allowed"}}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":true,"dependencies":{"minUI5Version":"1.139.0","libs":{"sap.m":{},"sap.ui.core":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"com.ai.ragui.i18n.i18n","supportedLocales":[""]}},"oChatModel":{"type":"sap.ui.model.json.JSONModel","settings":{},"preload":false},"oLoggedInUser":{"type":"sap.ui.model.json.JSONModel","settings":{},"preload":false},"":{"dataSource":"mainService","preload":true,"settings":{"operationMode":"Server","autoExpandSelect":true,"earlyRequests":true}}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","controlAggregation":"pages","controlId":"app","transition":"slide","type":"View","viewType":"XML","path":"com.ai.ragui.view","async":true,"viewPath":"com.ai.ragui.view"},"routes":[{"name":"RouteMain","pattern":":?query:","target":["TargetMain"]}],"targets":{"TargetMain":{"id":"Main","name":"Main"}}},"rootView":{"viewName":"com.ai.ragui.view.App","type":"XML","id":"App","async":true}},"sap.cloud":{"public":true,"service":"rag-vector-engine"}}',
	"com/ai/ragui/view/App.view.xml":'<mvc:View controllerName="com.ai.ragui.controller.App"\n    displayBlock="true"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"><App id="app"></App></mvc:View>',
	"com/ai/ragui/view/Main.view.xml":'<mvc:View controllerName="com.ai.ragui.controller.Main"\n    xmlns:unified="sap.ui.unified"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"\n    xmlns:l="sap.ui.layout"\n    xmlns:upload="sap.m.upload"\n    xmlns:mdcat="sap.ui.mdc.actiontoolbar"\n    xmlns:core="sap.ui.core"\n><Page id="sideContentContainer"\n        showHeader="false"\n        showNavButton="false"><l:DynamicSideContent\n            id="DynamicSideContent"\n            class="sapUiDSCExplored sapUiContentPadding"\n            containerQuery="true"\n            sideContentFallDown="BelowM"\n            breakpointChanged=".handleBreakpointChangeEvent"\n            showSideContent="{UserData>/showSideContent}"\n        ><l:mainContent><Page\n                    id="_IDGenPage"\n                    showHeader="false"\n                    showFooter="true"\n                    class="chatPage"\n                    enableScrolling="false"\n                ><HBox\n                        id="_IDGenHBox"\n                        class="header"\n                        justifyContent="SpaceBetween"\n                        alignItems="Center"\n                    ><HBox\n                            id="_IDGenHBox1"\n                            class="modelSelector"\n                            alignItems="Center"\n                        ><core:Icon\n                                id="_IDGenIcon"\n                                src="sap-icon://da"\n                                size="1.5rem"\n                                class="dropdownArrow"\n                            /><Text\n                                id="_IDGenText"\n                                text="ChatBot"\n                                class="modelText"\n                            /></HBox><HBox\n                            id="_IDGenHBox2"\n                            alignItems="Center"\n                        ><HBox id="_IDGenHBox3"><core:Icon\n                                    id="_IDGenIcon1"\n                                    class="headerBtn sapUiLargeMarginLeft"\n                                    src="sap-icon://refresh"\n                                    press=".onReloadChat"\n                                /></HBox></HBox></HBox><ScrollContainer\n                        busyIndicatorDelay="1000"\n                        id="chatScroll"\n                        height="75%"\n                        class="chatConversation"\n                        vertical="true"\n                        horizontal="false"\n                        focusable="false"\n                        width="100%"\n                    ><VBox\n                            id="_IDGenVBox"\n                            class="customMainBox"\n                            fitContainer="true"\n                            width="100%"\n                        ><VBox\n                                id="_IDGenVBox1"\n                                alignItems="Center"\n                                justifyContent="Center"\n                                class="greetingBox"\n                            ><Text\n                                    id="_IDGenText1"\n                                    text="{= ${UserData>/firstname} ? \'Hello, \' + ${UserData>/firstname} : \'Hello\' }"\n                                    class="greetingText"\n                                /></VBox><VBox\n                                id="messagesVBox"\n                                items="{oChatModel>/list}"\n                                width="100%"\n                            ><HBox\n                                    id="_IDGenHBox4"\n                                    width="100%"\n                                    class="chatRow"\n                                    justifyContent="{= ${oChatModel>type} === \'query\' ? \'End\' : \'Start\'}"\n                                ><HBox\n                                        id="_IDGenHBox5"\n                                        visible="{= ${oChatModel>type} === \'query\'}"\n                                        class="bubbleRow sapUiSmallMarginTop sapUiSmallMarginBottom"\n                                        alignItems="End"\n                                        width="auto"\n                                    ><Text\n                                            id="_IDGenText2"\n                                            renderWhitespace="false"\n                                            textAlign="Begin"\n                                            textDirection="LTR"\n                                            text="{oChatModel>text}"\n                                            class="userMessage"\n                                            width="auto"\n                                            wrapping="true"\n                                        /><core:Icon\n                                            id="_IDGenIcon3"\n                                            src="sap-icon://person-placeholder"\n                                            size="1.5rem"\n                                            class="sapUiTinyMarginBeginEnd"\n                                        /></HBox><HBox\n                                        id="_IDGenHBox6"\n                                        visible="{= ${oChatModel>type} === \'response\'}"\n                                        class="bubbleRow sapUiSmallMarginTop sapUiSmallMarginBottom"\n                                        alignItems="End"\n                                        width="100%"\n                                    ><core:Icon\n                                            id="_IDGenIcon4"\n                                            src="sap-icon://da"\n                                            size="1.5rem"\n                                            class="sapUiTinyMarginBeginEnd"\n                                        /><FormattedText\n                                            id="_IDGenFormattedText"\n                                            htmlText="{oChatModel>text}"\n                                            busy="{oChatModel>busy}"\n                                            class="assistantMessage"\n                                            width="90%"\n                                        /></HBox></HBox></VBox></VBox></ScrollContainer><footer><Toolbar\n                            class="greetingBox"\n                            id="_IDGenToolbar"\n                            height="auto"\n                            design="Solid"\n                            width="95%"\n                        ><FeedInput\n                                class="customInputHeight"\n                                id="userInput"\n                                placeholder="Ask anything ..."\n                                post=".onSendMessage"\n                            /></Toolbar></footer></Page></l:mainContent><l:sideContent><Toolbar id="_IDGenToolbar4" class="Toolbar"><Title id="documentCount" text="Documents ({/DocumentFiles/$count})" /></Toolbar><Toolbar\n                    id="_IDGenToolbar1"\n                    class="Toolbar"\n                ><SearchField\n                        id="searchDocuments"\n                        class="sapUiSmallMarginRight sapUiSmallMarginTop"\n                        search=".onSearchDocuments"\n                    /><ToolbarSpacer id="_IDGenToolbarSpacer" /><unified:FileUploader\n                        fileType="pdf"\n                        valueState="None"\n                        id="idFileUploader"\n                        buttonOnly="true"\n                        buttonText="Upload"\n                        name="myFileUpload"\n                        tooltip="Upload your file"\n                        uploadOnChange="true"\n                        change=".onChange"\n                        maximumFileSize="5"\n                        fileSizeExceed=".onFileSizeExceed"\n                    /></Toolbar><l:VerticalLayout\n                    id="_IDGenVerticalLayout"\n                    width="100%"\n                ><List\n                        id="idList"\n                        items="{/DocumentFiles}"\n                        growing="true"\n                        growingThreshold="50"\n                        delete=".onFileDeleted"\n                        mode="Delete"\n                        backgroundDesign="Transparent"\n                        updateFinished=".updateFileCount"\n                    ><infoToolbar><OverflowToolbar\n                                visible="false"\n                                id="idInfoToolbar"\n                            ><Label id="idFilterLabel" /></OverflowToolbar></infoToolbar><StandardListItem\n                            id="_IDGenStandardListItem"\n                            title="{fileName}"\n                            iconDensityAware="false"\n                            iconInset="false"\n                        /></List></l:VerticalLayout></l:sideContent></l:DynamicSideContent><footer><Toolbar\n                id="_IDGenToolbar2"\n                visible="{UserData>/showSideContent}"\n            ><Button\n                    text="Toggle"\n                    type="Accept"\n                    press=".handleToggleClick"\n                    id="toggleButton"\n                /><Button\n                    text="Upload Documents"\n                    id="showSideContentButton"\n                    press=".handleSideContentShow"\n                    visible="false"\n                /><Slider\n                    id="DSCWidthSlider"\n                    value="100"\n                    liveChange=".handleSliderChange"\n                    visible="{= !${media>/phone}}"\n                /><Text\n                    id="DSCWidthHintText"\n                    text="Best view in full screen"\n                    visible="{= !${media>/phone}}"\n                /></Toolbar></footer></Page></mvc:View>'
});
//# sourceMappingURL=Component-preload.js.map
